<!-- See the LICENSE file at https://github.com/wavesplatform/WavesGUI/blob/master/LICENSE. Removal or modification of this copyright notice is prohibited. -->

<!DOCTYPE html>
<html ng-app="app">
<head>
    <meta charset="utf-8">
    <title>Waves Client</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        .app-loader {
            z-index: 10000;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #fff;
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
        }

        .app-loader .progress {
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 3px;
            background-color: #0065D7;
            transition: width 1s;
            -webkit-transition: width 1s;
            -moz-transition: width 1s;
        }

        .loader-wrapper {
            position: fixed;
            left: 50%;
            top: 50%;
            margin-top: -150px;
            margin-left: -100px;
            width: 200px;
            height: 200px;
            text-align: center;
        }

        .loader {
            width: 100px;
            height: 100px;
            display: inline-block;
            -moz-transform: rotate(45deg);
            -ms-transform: rotate(45deg);
            -webkit-transform: rotate(45deg);
            transform: rotate(45deg);
        }

        .loader span {
            position: relative;
            width: 50px;
            height: 50px;
            -moz-transform: scale(1.1);
            -ms-transform: scale(1.1);
            -webkit-transform: scale(1.1);
            transform: scale(1.1);
            display: inline-block;
        }

        .loader span::before {
            content: '';
            background-color: #1f5af6;
            position: absolute;
            left: 0;
            top: 0;
            display: block;
            width: 50px;
            height: 50px;
            -moz-transform-origin: 100% 100%;
            -ms-transform-origin: 100% 100%;
            -webkit-transform-origin: 100% 100%;
            transform-origin: 100% 100%;
            -moz-animation: folding 2.5s infinite linear both;
            -webkit-animation: folding 2.5s infinite linear both;
            animation: folding 2.5s infinite linear both;
        }

        .loader .leaf2 {
            -moz-transform: rotateZ(90deg) scale(1.1);
            -ms-transform: rotateZ(90deg) scale(1.1);
            -webkit-transform: rotateZ(90deg) scale(1.1);
            transform: rotateZ(90deg) scale(1.1);
        }

        .loader .leaf2::before {
            -moz-animation-delay: 0.3s;
            -webkit-animation-delay: 0.3s;
            animation-delay: 0.3s;
            background-color: #0a49f2;
        }

        .loader .leaf3 {
            -moz-transform: rotateZ(270deg) scale(1.1);
            -ms-transform: rotateZ(270deg) scale(1.1);
            -webkit-transform: rotateZ(270deg) scale(1.1);
            transform: rotateZ(270deg) scale(1.1);
        }

        .loader .leaf3::before {
            -moz-animation-delay: 0.9s;
            -webkit-animation-delay: 0.9s;
            animation-delay: 0.9s;
            background-color: #0a49f2;
        }

        .loader .leaf4 {
            -moz-transform: rotateZ(180deg) scale(1.1);
            -ms-transform: rotateZ(180deg) scale(1.1);
            -webkit-transform: rotateZ(180deg) scale(1.1);
            transform: rotateZ(180deg) scale(1.1);
        }

        .loader .leaf4::before {
            -moz-animation-delay: 0.6s;
            -webkit-animation-delay: 0.6s;
            animation-delay: 0.6s;
            background-color: #0942d9;
        }

        @-moz-keyframes folding {
            0%, 10% {
                -moz-transform: perspective(140px) rotateX(-180deg);
                transform: perspective(140px) rotateX(-180deg);
                opacity: 0;
            }
            25%, 75% {
                -moz-transform: perspective(140px) rotateX(0deg);
                transform: perspective(140px) rotateX(0deg);
                opacity: 1;
            }
            90%, 100% {
                -moz-transform: perspective(140px) rotateY(180deg);
                transform: perspective(140px) rotateY(180deg);
                opacity: 0;
            }
        }

        @-webkit-keyframes folding {
            0%, 10% {
                -webkit-transform: perspective(140px) rotateX(-180deg);
                transform: perspective(140px) rotateX(-180deg);
                opacity: 0;
            }
            25%, 75% {
                -webkit-transform: perspective(140px) rotateX(0deg);
                transform: perspective(140px) rotateX(0deg);
                opacity: 1;
            }
            90%, 100% {
                -webkit-transform: perspective(140px) rotateY(180deg);
                transform: perspective(140px) rotateY(180deg);
                opacity: 0;
            }
        }

        @keyframes folding {
            0%, 10% {
                -moz-transform: perspective(140px) rotateX(-180deg);
                -ms-transform: perspective(140px) rotateX(-180deg);
                -webkit-transform: perspective(140px) rotateX(-180deg);
                transform: perspective(140px) rotateX(-180deg);
                opacity: 0;
            }
            25%, 75% {
                -moz-transform: perspective(140px) rotateX(0deg);
                -ms-transform: perspective(140px) rotateX(0deg);
                -webkit-transform: perspective(140px) rotateX(0deg);
                transform: perspective(140px) rotateX(0deg);
                opacity: 1;
            }
            90%, 100% {
                -moz-transform: perspective(140px) rotateY(180deg);
                -ms-transform: perspective(140px) rotateY(180deg);
                -webkit-transform: perspective(140px) rotateY(180deg);
                transform: perspective(140px) rotateY(180deg);
                opacity: 0;
            }
        }
    </style>

    <script>

        var __controllers = Object.create(null);

        /**
         * @type {IWavesApp}
         */
        var WavesApp = {
            name: '{{pack.name}}',
            version: '{{pack.version}}',
            type: '{{build.type}}',
            network: {
                code: '{{network.code}}',
                node: '{{network.node}}',
                matcher: '{{network.matcher}}',
                api: '{{network.api}}',
                coinomat: '{{network.coinomat}}',
                datafeed: '{{network.datafeed}}'
            },
            defaultAssets: {
                WAVES: 'WAVES',
                EUR: '{{network.assets.EUR}}',
                USD: '{{network.assets.USD}}',
                BTC: '{{network.assets.BTC}}',
                ETH: '{{network.assets.ETH}}'
            },
            remappedAssetNames: {
                '{{network.assets.EUR}}': 'Euro',
                '{{network.assets.USD}}': 'US Dollar',
                '{{network.assets.BTC}}': 'Bitcoin',
                '{{network.assets.ETH}}': 'Ethereum'
            },
            dex: {
                resolutions: ['15', '30', '60', '240', '1440'], // TODO : add months
                defaultResolution: '60'
            },
            modules: [],
            addController(name, controller) {
                __controllers[name] = controller;
            },
            getController(name) {
                return __controllers[name];
            },
            isWeb() {
                return this.type === 'web';
            },
            isDesktop() {
                return this.type === 'desktop';
            },
            stateTree: null
        };

    </script>

    <!-- CSS -->
    <base href="/">

</head>

<body>

<div class="app-loader">
    <div class="progress"></div>
    <div class="loader-wrapper">
        <div class="loader"><span class="leaf1"></span><span class="leaf2"></span><span class="leaf3"></span><span
                class="leaf4"></span></div>
    </div>
</div>

<ui-view name="main"></ui-view>

<!-- JAVASCRIPT -->

<script>

    var Waves = WavesAPI.create({
        networkByte: WavesApp.network.code.charCodeAt(0),
        nodeAddress: WavesApp.network.node,
        matcherAddress: WavesApp.network.matcher
    });

    WavesApp.stateTree = new tsUtils.Tree({
        id: 'root',
        children: [
            {
                id: 'welcome',
                data: {
                    url: '/',
                    noLogin: true,
                    views: [{ name: 'main' }]
                }
            },
            {
                id: 'create',
                data: {
                    noLogin: true,
                    views: [{ name: 'main' }]
                }
            },
            {
                id: 'restore',
                data: {
                    noLogin: true,
                    views: [{ name: 'main' }]
                }
            },
            {
                id: 'main',
                data: {
                    abstract: true,
                    views: [{ name: 'main', templateUrl: 'modules/app/templates/main.html' }]
                },
                children: [
                    {
                        id: 'wallet',
                        data: {
                            views: [{
                                name: 'mainContent',
                                noController: true,
                                template: '<ui-view name="content"></ui-view>'
                            }],
                            redirectTo: 'main.wallet.assets'
                        },
                        children: [
                            { id: 'assets', data: { views: [{ name: 'content' }] } },
                            { id: 'portfolio', data: { views: [{ name: 'content' }] } },
                            { id: 'transactions', data: { views: [{ name: 'content' }] } },
                            { id: 'leasing', data: { views: [{ name: 'content' }] } }
                        ]
                    },
                    {
                        id: 'dex',
                        data: {
                            views: [{ name: 'mainContent' }]
                        }
                    },
                    {
                        id: 'tokens',
                        data: {
                            views: [{ name: 'mainContent' }]
                        }
                    }
                ]
            }
        ]
    });

    /**
     * @typedef {object} IWavesApp
     * @property {string} name
     * @property {string} version
     * @property {string} type
     * @property {number} addressLength
     * @property {object} network
     * @property {string} network.code
     * @property {string} network.node
     * @property {string} network.matcher
     * @property {string} network.api
     * @property {string} network.coinomat
     * @property {string} network.datafeed
     * @property {object} defaultAssets
     * @property {string} defaultAssets.WAVES
     * @property {string} defaultAssets.EUR
     * @property {string} defaultAssets.USD
     * @property {string} defaultAssets.BTC
     * @property {string} defaultAssets.ETH
     * @property {object} remappedAssetNames
     * @property {object} dex
     * @property {Array<string>} dex.resolutions
     * @property {string} dex.defaultResolution
     * @property {Array<string>} modules
     * @property {Function} isWeb
     * @property {Function} isDesktop
     * @property {Function} addController
     * @property {Function} getController
     * @property {Tree} stateTree
     */

</script>

</body>
</html>
